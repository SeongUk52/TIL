# 9장 단위 테스트

- 애자일과 TDD 덕택에 단위 테스트를 자동화하는 프로그래머들이 이미 많아졌으며 점점 더 늘어나는 추세다.
- 제대로 된 테스트 케이스를 작성해야 한다.

## TDD 법칙 세 가지

1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.


- 실제 코드와 맞먹을 정도로 방대한 테스트 코드는 심각한 관리 문제를 유발하기도 한다.


## 깨끗한 테스트 코드 유지하기

- 실제 코드가 진화하면 테스트 코드도 변해야 한다.
- 테스트 코드가 지저분할수록 변경하기 어려워진다.
- 테스트 코드는 실제 코드 못지않게 중요하다.

### 테스트는 유연성, 유지보수성, 재사용성을 제공한다

- 코드에 유연성, 유지보수성, 재사용성을 제공하는 버팀목이 바로 단위 테스트다.
- 테스트 케이스가 있으면 변경이 두렵지 않다.
- 테스트 커버리지가 높을수록 공포는 줄어든다.
- 테스트 코드가 지저분하면 코드를 변경하는 능력이 떨어지며 코드 구조를 개선하는 능력도 떨어진다.


## 깨끗한 테스트 코드
- 테스트 코드는 가독성이 매우 중요함
- 테스트 코드에서 가독성을 높이는 법: 명료성, 단순성, 풍부한 표현력이 필요


- 테스트 코드는 본론에 돌입해 진짜 필요한 자료 유형과 함수만 사용한다. 그러므로 코드를 읽는 사람은 온갖 잡다하고 세세한 코드에 주눅들고
헷갈릴 필요 없이 코드가 수행하는 기능을 재빨리 이해한다.


### 도메인에 특화된 테스트 언어
- DSL은 테스트를 구현하는 당사자와 나중에 테스트를 읽어볼 독자를 도와주는 테스트 언어

### 이중 표준
- 테스트 API코드에 적용하는 표준은 실제 코드에 적용하는 표준과 확실히 다르다.
- 실제 코드만큼 효율적일 필요는 없다.


### 테스트당 개념 하나
- 이것저것 잡다한 개념을 연속으로 테스트하는 긴 함수는 피한다.
- 가장 좋은 규칙은 "개념 당 assert 문 수를 최소로 줄여라"와 "테스트 함수 하나는 개념 하나만 테스트하라"


## F.I.R.S.T.
    
- 빠르게(Fast)
  - 테스트는 빨리 돌아야 한다.
  - 테스트가 느리면 -> 자주 돌릴 엄두를 못 낸다 -> 문제를 찾아내 고치지 못한다 -> 마음껏 정리하지도 못한다 -> 코드 품질이
망가지기 시작한다.


- 독립적으로(Independent)
  - 각 테스트는 서로 의존하면 안 된다.
    - 한 테스트가 다음 테스트가 실행될 환경을 준비해서는 안 된다
    - 각 테스트는 독립적으로 그리고 어떤 순서로 실행해도 괜찮아야 한다.
  - 테스트가 서로에게 의존적 -> 하나가 실패할 때 나머지도 잇달아 실패 -> 원인을 진단하기 어려워지며 후반 테스트가 찾아내야 할
결함이 숨겨짐



- 반복가능하게(Repeatable)
  - 테스트는 어떤 환경에서도 반복 가능해야 한다.
  - 실제 환경, QA 환경, 버스를 타고 집으로 가는 길에 사용하는 노트북 환경에서도 실행할 수 있어야 한다.


- 자가검증하는(Self-Validating)
  - 테스트는 부울(bool)값으로 결과를 내야 한다.
  - 통과 여부를 알려고 로그 파일을 읽게 만들어서는 안 된다.
  

- 적시에(Timely)
  - 단위 테스트는 테스트하려는 실제 코드를 구현하기 직전에 구현한다.


## 결론
- 테스트 코드는 실제 코드 만큼이나 프로젝트 건강에 중요하다.
- 테스트 코드는 실제 코드의 유연성, 유지보수성, 재사용성을 보존하고 강화하기 때문
- 테스트 API를 구현해 도메인 특화 언어(Domain Specific Language, DSL)를 만들자.
- 테스트 코드가 방치되어 망가지면 실제 코드도 망가진다. 테스트 코드를 깨끗하게 유지하자.


## 독후감

---
테스트 코드의 중요성과 F.I.S.R.T. 규칙 등 테스트 코드를 잘 작성하는 방법을 배웠다. 프리코스 때도 단위 테스트를 잘 작성하도록
노력해야겠다.